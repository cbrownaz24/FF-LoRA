Unsupported operator aten::embedding encountered 1 time(s)
Unsupported operator aten::add encountered 121 time(s)
Unsupported operator aten::cos encountered 1 time(s)
Unsupported operator aten::sin encountered 1 time(s)
Unsupported operator aten::mul encountered 122 time(s)
Unsupported operator aten::neg encountered 48 time(s)
Unsupported operator aten::scaled_dot_product_attention encountered 24 time(s)
Unsupported operator aten::gelu encountered 24 time(s)
The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
base_model.model.gpt_neox.layers.0.attention.attention_dropout, base_model.model.gpt_neox.layers.0.attention.rotary_emb, base_model.model.gpt_neox.layers.1.attention.attention_dropout, base_model.model.gpt_neox.layers.1.attention.rotary_emb, base_model.model.gpt_neox.layers.10.attention.attention_dropout, base_model.model.gpt_neox.layers.10.attention.rotary_emb, base_model.model.gpt_neox.layers.11.attention.attention_dropout, base_model.model.gpt_neox.layers.11.attention.rotary_emb, base_model.model.gpt_neox.layers.12.attention.attention_dropout, base_model.model.gpt_neox.layers.12.attention.rotary_emb, base_model.model.gpt_neox.layers.13.attention.attention_dropout, base_model.model.gpt_neox.layers.13.attention.rotary_emb, base_model.model.gpt_neox.layers.14.attention.attention_dropout, base_model.model.gpt_neox.layers.14.attention.rotary_emb, base_model.model.gpt_neox.layers.15.attention.attention_dropout, base_model.model.gpt_neox.layers.15.attention.rotary_emb, base_model.model.gpt_neox.layers.16.attention.attention_dropout, base_model.model.gpt_neox.layers.16.attention.rotary_emb, base_model.model.gpt_neox.layers.17.attention.attention_dropout, base_model.model.gpt_neox.layers.17.attention.rotary_emb, base_model.model.gpt_neox.layers.18.attention.attention_dropout, base_model.model.gpt_neox.layers.18.attention.rotary_emb, base_model.model.gpt_neox.layers.19.attention.attention_dropout, base_model.model.gpt_neox.layers.19.attention.rotary_emb, base_model.model.gpt_neox.layers.2.attention.attention_dropout, base_model.model.gpt_neox.layers.2.attention.rotary_emb, base_model.model.gpt_neox.layers.20.attention.attention_dropout, base_model.model.gpt_neox.layers.20.attention.rotary_emb, base_model.model.gpt_neox.layers.21.attention.attention_dropout, base_model.model.gpt_neox.layers.21.attention.rotary_emb, base_model.model.gpt_neox.layers.22.attention.attention_dropout, base_model.model.gpt_neox.layers.22.attention.rotary_emb, base_model.model.gpt_neox.layers.23.attention.attention_dropout, base_model.model.gpt_neox.layers.23.attention.rotary_emb, base_model.model.gpt_neox.layers.3.attention.attention_dropout, base_model.model.gpt_neox.layers.3.attention.rotary_emb, base_model.model.gpt_neox.layers.4.attention.attention_dropout, base_model.model.gpt_neox.layers.4.attention.rotary_emb, base_model.model.gpt_neox.layers.5.attention.attention_dropout, base_model.model.gpt_neox.layers.5.attention.rotary_emb, base_model.model.gpt_neox.layers.6.attention.attention_dropout, base_model.model.gpt_neox.layers.6.attention.rotary_emb, base_model.model.gpt_neox.layers.7.attention.attention_dropout, base_model.model.gpt_neox.layers.7.attention.rotary_emb, base_model.model.gpt_neox.layers.8.attention.attention_dropout, base_model.model.gpt_neox.layers.8.attention.rotary_emb, base_model.model.gpt_neox.layers.9.attention.attention_dropout, base_model.model.gpt_neox.layers.9.attention.rotary_emb
Traceback (most recent call last):
  File "/home/connorb/FF-LoRA/main.py", line 429, in <module>
    vanilla_final_loss, vanilla_test_curve, vanilla_time, vanilla_flops = vanilla_train(
  File "/home/connorb/FF-LoRA/main.py", line 243, in vanilla_train
    batch = next(train_iter, None)
  File "/home/connorb/miniforge3/envs/myenv/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 701, in __next__
    data = self._next_data()
  File "/home/connorb/miniforge3/envs/myenv/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 757, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/connorb/miniforge3/envs/myenv/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 33, in fetch
    data.append(next(self.dataset_iter))
  File "/home/connorb/FF-LoRA/main.py", line 108, in __iter__
    for item in self.base_dataset:
  File "/home/connorb/FF-LoRA/main.py", line 85, in __iter__
    for raw_example in self.hf_stream:
  File "/home/connorb/miniforge3/envs/myenv/lib/python3.9/site-packages/datasets/iterable_dataset.py", line 2093, in __iter__
    for key, example in ex_iterable:
  File "/home/connorb/miniforge3/envs/myenv/lib/python3.9/site-packages/datasets/iterable_dataset.py", line 1511, in __iter__
    yield from islice(self.ex_iterable, ex_iterable_idx_start, None)
  File "/home/connorb/miniforge3/envs/myenv/lib/python3.9/site-packages/datasets/iterable_dataset.py", line 1454, in __iter__
    for x in self.ex_iterable:
  File "/home/connorb/miniforge3/envs/myenv/lib/python3.9/site-packages/datasets/iterable_dataset.py", line 356, in __iter__
    formatted_batch = formatter.format_batch(pa_subtable)
  File "/home/connorb/miniforge3/envs/myenv/lib/python3.9/site-packages/datasets/formatting/formatting.py", line 455, in format_batch
    batch = self.python_arrow_extractor().extract_batch(pa_table)
  File "/home/connorb/miniforge3/envs/myenv/lib/python3.9/site-packages/datasets/formatting/formatting.py", line 151, in extract_batch
    return pa_table.to_pydict()
  File "pyarrow/table.pxi", line 2280, in pyarrow.lib._Tabular.to_pydict
  File "pyarrow/array.pxi", line 1656, in pyarrow.lib.Array.to_pylist
  File "pyarrow/scalar.pxi", line 713, in pyarrow.lib.ListScalar.as_py
  File "pyarrow/array.pxi", line 1656, in pyarrow.lib.Array.to_pylist
  File "pyarrow/scalar.pxi", line 794, in pyarrow.lib.StructScalar.as_py
  File "/home/connorb/miniforge3/envs/myenv/lib/python3.9/_collections_abc.py", line 775, in keys
    def keys(self):
KeyboardInterrupt
